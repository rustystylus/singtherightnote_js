<!DOCTYPE html>
<html>
<head>
	<title>singtherightnote</title>
	<link media="all" type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="http://rustystylus.co.uk/js/jquery.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    
    <script src="js/musicpanel.js" type="text/javascript"></script>
	<script src="js/noteplayer.js" type="text/javascript"></script>
</head>

<body>
    <div class="container">
            <div class="row">
            	<h1>singtherightnote</h1>
            </div>  
            <div class="row">          
	            <div class="col-md-4">
	            	<form>
					<select name=selectRange onchange='OnRangeChange(this.form.selectRange);'>
						<option>Suprano</option>
						<option>Tenor</option>
						<option>Bass</option>
					</select>
					<button id="playnote"  class="btn btn-default" onclick='PlayNote()'>Play Note</button>
					</form>
	            </div>
	            <div class="col-md-4">  
					<canvas id="musicCanvas" width="400" height="400"	style="border:1px solid #c3c3c3;">
					Your browser does not support the HTML5 canvas tag.
					</canvas>
				</div>
	            <div class="col-md-4">
	            </div>
        	</div>
    </div>
            
<script>
var noteplayer = new NotePlayer();
var mPanel = new MusicPanel();

window.onload=function() 
{
	initialise();

};	
	var c = document.getElementById("musicCanvas");
	var context = c.getContext("2d");
	context.fillStyle = "#000000";
	
	mPanel.drawPanel(context);

	
	mPanel.setInputNote(38);
	mPanel.drawInputNote(context);
	mPanel.setOutputNote(40);
	mPanel.drawOutputNote(context);
		//draw note
	//scale context horizontally
/*	
	// create radial gradient
	var grd = context.createRadialGradient(2, 2, 10, 3, 3, 10);

	context.fillStyle = grd;
	context.fill();
*/

	

function OnRangeChange(dropdown)
{
    var myindex  = dropdown.selectedIndex;
    var SelValue = dropdown.options[myindex].value;
    switch(myindex)
    {
	    case 1:
	    	mPanel.setRange(context,32,36);
	    	break;
	    case 2:
	    	mPanel.setRange(context,36,40);
	    	break;
	    default:
	    	mPanel.setRange(context,40,42);
	    	break;
	}
    //var baseURL  = <Some value based on SelValue>
    //top.location.href = baseURL; 
    return true;
}

function initialise()
{

	window.addEventListener('load', init, false);
    function init() {
      try {
        // Fix up for prefixing
        window.AudioContext = window.AudioContext||window.webkitAudioContext;
        audioContext = new AudioContext();
        alert('Web Audio API is supported in this browser');
      }
      catch(e) {
        alert('Web Audio API is not supported in this browser');
      }
    }
	
}
function PlayNote()
{
	noteplayer.playNote()

}
</script>

</body>
</html>